/*! jQuery SimpleTimetable Plugin v1.0.0 | Includes jquery.simple_table.js | Includes jquery.simple_dateformat.js | Copyright 2014 criticalbreak5's | opensource.org/licenses/mit-license.php */
(function(d){d.fn.simple_timetable=function(a){function g(a,b,h){return d.simple_dateparse(d.simple_dateformat(a,b)+h,"yyyyMMddHHmmssSSS")}function h(a){return Number(a.split("px").join(""))}a=d.extend({"col-headers-override-height":"40px","row-headers-override-width":"100px","start-date":new Date,interval:"d",data:[]},a);a["ruled-line-border-style"]="solid";a["ruled-line-border-width"]="1px";switch(a.interval){case "s":a["start-date"]=g(a["start-date"],"yyyyMMddHHmmss","000");break;case "m":a["start-date"]=
g(a["start-date"],"yyyyMMddHHmm","00000");break;case "H":a["start-date"]=g(a["start-date"],"yyyyMMddHH","0000000");break;case "d":a["start-date"]=g(a["start-date"],"yyyyMMdd","000000000");break;default:a["start-date"]=g(a["start-date"],"yyyyMMdd","000000000")}if(!a["end-date"])switch(a["end-date"]=new Date(a["start-date"].getTime()),a.interval){case "s":a["end-date"].setSeconds(a["end-date"].getSeconds()+30);break;case "m":a["end-date"].setMinutes(a["end-date"].getMinutes()+30);break;case "H":a["end-date"].setHours(a["end-date"].getHours()+
30);break;case "d":a["end-date"].setDate(a["end-date"].getDate()+30);break;default:a["end-date"].setDate(a["end-date"].getDate()+210)}if(!a["col-headers-format"])switch(a.interval){case "s":a["col-headers-format"]="yyyy/MM/dd<br />HH:mm:ss";break;case "m":a["col-headers-format"]="yyyy/MM/dd<br />HH:mm:00";break;case "H":a["col-headers-format"]="yyyy/MM/dd<br />HH:00:00";break;case "d":a["col-headers-format"]="<br />yyyy/MM/dd";break;default:a["col-headers-format"]="<br />yyyy/MM/dd"}return this.each(function(){d(this).empty();
for(var c=[],b=new Date(a["start-date"].getTime()),g=a["end-date"];b.getTime()<g.getTime();){var l=d.simple_dateformat(b,a["col-headers-format"]);c.push(l);switch(a.interval){case "s":b.setSeconds(b.getSeconds()+1);break;case "m":b.setMinutes(b.getMinutes()+1);break;case "H":b.setHours(b.getHours()+1);break;case "d":b.setDate(b.getDate()+1);break;default:b.setDate(b.getDate()+7)}}a.cols=c.length;a["col-headers"]=c;d(this).simple_table(a);d("#"+a["top-left-header-id"]).css({height:a["col-headers-override-height"]});
for(c=1;0!=d("#"+a["col-headers-id-prefix"]+String(c)).size();)d("#"+a["col-headers-id-prefix"]+String(c)).css({height:a["col-headers-override-height"]}),c++;d("#"+a["top-left-header-id"]).css({width:a["row-headers-override-width"]});for(c=1;0!=d("#"+a["row-headers-id-prefix"]+String(c)).size();)d("#"+a["row-headers-id-prefix"]+String(c)).css({width:a["row-headers-override-width"]}),c++;for(var g={position:"absolute",height:a["ruled-line-height"],overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",
"border-style":a["ruled-line-border-style"],"border-width":a["ruled-line-border-width"]},l=new Date(a["start-date"].getTime()),b=new Date(b.getTime()),w=h(a["col-headers-override-height"]),x=h(a["row-headers-override-width"]),t=h(a["ruled-line-width"]),q=h(a["ruled-line-border-width"]),y=h(a["ruled-line-border-width"]),z=h(a["ruled-line-height"]),u=(b.getTime()-l.getTime())/1E3/(t*a.cols),n=a.data,v=0,c=0;c<n.length;c++)for(var k=0;k<n[c].length;k++)for(var p=0;p<n[c][k].length;p++)if(v++,!(n[c][k][p]["end-date"].getTime()<=
l.getTime()||b.getTime()<=n[c][k][p]["start-date"].getTime())){var e={},e=d.extend(n[c][k][p],e),r={id:"data_id_"+String(v),title:"",color:"#000000","background-color":"#FFFFFF","border-color":"#000000","box-shadow":"0px 0px 0px 0px rgba(0, 0, 0, 0)"},m=e["start-date"].getTime()<l.getTime()?l:e["start-date"],f=((b.getTime()<e["end-date"].getTime()?b:e["end-date"]).getTime()-m.getTime())/1E3/u,f=Math.ceil(f+(f/t*q-q)),s=w+z*k+y*k,m=x+(m.getTime()-l.getTime())/1E3/u,m=Math.floor(m+(m/t*q-q)),f={width:f+
"px",top:s+"px",left:m+"px"},e=d.extend(r,e),r=e.id,s=e.title,e=[g,f,{color:e.color,"background-color":e["background-color"],"border-color":e["border-color"],"box-shadow":e["box-shadow"]}];d(this).append("<div id='"+r+"' title='"+s+"'>"+s+"</div>");for(f=0;f<e.length;f++)d("#"+r).css(e[f])}})}})(jQuery);
